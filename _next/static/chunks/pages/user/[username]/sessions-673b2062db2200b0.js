(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{5221:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/[username]/sessions",function(){return c(8670)}])},8670:function(a,b,c){"use strict";c.r(b);var d=c(4776),e=c.n(d),f=c(6753),g=c(2139),h=c(2066),i=c(1746),j=c(6681),k=c(5488),l=c(1346),m=c(6893),n=c(4687);function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function p(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){o(f,d,e,g,h,"next",a)}function h(a){o(f,d,e,g,h,"throw",a)}g(void 0)})}}b.default=function(){var a=(0,h.useQueryClient)(),b=(0,i.Sz)(m.Q,function(a){return a.get}),c=(0,g.useState)(null),d=c[0],o=c[1],q=(0,h.useQuery)("fetch-refresh-tokens",p(e().mark(function a(){var b;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.h.get("/auth/refresh-token");case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)}))),r=q.data,s=q.isLoading;(0,g.useEffect)(function(){function a(){return(a=p(e().mark(function a(){var c,d,f;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=b("@neo:refresh"),a.next=3,n.h.get("/auth/refresh-token/".concat(c));case 3:o(f=(d=a.sent).data);case 6:case"end":return a.stop()}},a)}))).apply(this,arguments)}!function(){return a.apply(this,arguments)}()},[b]);var t,u=(0,g.useMemo)(function(){return null==r?void 0:r.refreshToken.length},[null==r?void 0:r.refreshToken.length]),v=(0,g.useCallback)((t=p(e().mark(function b(c){var f,g,h;return e().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(f=!0,(null==d?void 0:d.id)===c&&(f=window.confirm("Do you really want to delete your local session?")),!f){b.next=17;break}if(!(g=a.getQueryData("fetch-refresh-tokens"))){b.next=17;break}return h=g.refreshToken.filter(function(a){return a.id!==c}),console.log({filteredRefreshTokens:h}),a.setQueryData("fetch-refresh-tokens",{refreshToken:h}),b.prev=8,b.next=11,n.h.delete("/auth/refresh-token",{data:{id:c}});case 11:b.next=17;break;case 13:b.prev=13,b.t0=b.catch(8),alert("failed to delete session, putting it back on the list"),a.setQueryData("fetch-refresh-tokens",{refreshToken:g.refreshToken});case 17:case"end":return b.stop()}},b,null,[[8,13]])})),function(a){return t.apply(this,arguments)}),[null==d?void 0:d.id,a]);return s?(0,f.tZ)("div",{children:(0,f.tZ)("p",{children:"bruh"})}):(0,f.BX)("div",{children:[(0,f.BX)("p",{style:{color:"black"},children:["you have ",(0,f.tZ)("strong",{children:u})," active tokens"]}),(0,f.tZ)("br",{}),(0,f.tZ)("ul",{children:null==r?void 0:r.refreshToken.map(function(a){var b=a.id,c=a.expiresIn,e=a.platform,g=a.createdAt,h=(null==d?void 0:d.id)===b,i=(0,j.Z)((0,k.Z)(new Date(g).toISOString()),"d MMM yy",{locale:l.Z}),m=(0,j.Z)((0,k.Z)(new Date(1e3*c).toISOString()),"d MMM yy",{locale:l.Z});return(0,f.BX)("li",{style:{color:"black"},children:[(0,f.tZ)("h4",{style:{color:"black"},children:b}),(0,f.tZ)("h5",{style:{color:"black"},children:e&&"".concat(e)}),(0,f.BX)("p",{style:{color:"black"},children:["created at: ",(0,f.tZ)("strong",{children:i})]}),(0,f.BX)("p",{style:{color:"black"},children:["expire date: ",(0,f.tZ)("strong",{children:m})]}),h&&(0,f.tZ)("div",{children:(0,f.tZ)("strong",{children:"this is your local session"})}),(0,f.tZ)("button",{onClick:function(){return v(b)},children:"delete this one"}),(0,f.tZ)("br",{}),(0,f.tZ)("br",{})]},b)})})]})}}},function(a){a.O(0,[618,774,888,179],function(){return a(a.s=5221)}),_N_E=a.O()}])