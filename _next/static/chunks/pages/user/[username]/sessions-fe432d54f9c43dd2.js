(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[509],{5221:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/[username]/sessions",function(){return c(8670)}])},8670:function(a,b,c){"use strict";c.r(b),c.d(b,{"default":function(){return l}});var d=c(4776),e=c.n(d),f=c(6753),g=c(2066),h=c(4687),i=c(2139);function j(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function k(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){j(f,d,e,g,h,"next",a)}function h(a){j(f,d,e,g,h,"throw",a)}g(void 0)})}}function l(){var a,b=(0,g.useQueryClient)(),c=(0,g.useQuery)("fetch-refresh-tokens",k(e().mark(function a(){var b;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,h.h.get("/auth/refresh-token");case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)}))),d=c.data,j=c.isLoading,l=(0,i.useMemo)(function(){return null==d?void 0:d.refreshToken.length},[null==d?void 0:d.refreshToken.length]),m=(0,i.useCallback)((a=k(e().mark(function a(c){var d,f;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(d=b.getQueryData("fetch-refresh-tokens"))){a.next=13;break}return f=d.refreshToken.filter(function(a){return a.id!==c}),b.setQueryData("fetch-refresh-tokens",{refreshToken:f}),a.prev=4,a.next=7,h.h.delete("/auth/refresh-token",{data:{id:c}});case 7:a.next=13;break;case 9:a.prev=9,a.t0=a.catch(4),alert("failed to delete session, putting it back on the list"),b.setQueryData("fetch-refresh-tokens",{refreshToken:d.refreshToken});case 13:case"end":return a.stop()}},a,null,[[4,9]])})),function(b){return a.apply(this,arguments)}),[b]);return j?(0,f.tZ)("div",{children:(0,f.tZ)("p",{children:"bruh"})}):(0,f.BX)("div",{children:[(0,f.BX)("p",{style:{color:"black"},children:["you have ",(0,f.tZ)("strong",{children:l})," active tokens"]}),(0,f.tZ)("br",{}),(0,f.tZ)("ul",{children:null==d?void 0:d.refreshToken.map(function(a){var b=a.id,c=a.expiresIn,d=a.platform;return(0,f.BX)("li",{children:[(0,f.tZ)("h4",{style:{color:"black"},children:b}),(0,f.tZ)("h5",{style:{color:"black"},children:d&&"".concat(d)}),(0,f.BX)("p",{style:{color:"black"},children:["expire date: ",(0,f.tZ)("strong",{children:c})]}),(0,f.tZ)("button",{onClick:function(){return m(b)},children:"delete this one"}),(0,f.tZ)("br",{}),(0,f.tZ)("br",{})]},b)})})]})}}},function(a){a.O(0,[774,888,179],function(){return a(a.s=5221)}),_N_E=a.O()}])