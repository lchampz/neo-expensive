(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{2326:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login/oauth/authorize",function(){return c(6605)}])},678:function(a,b,c){"use strict";c.d(b,{a:function(){return f}});var d=c(5774),e=c(1746);function f(){return{user:(0,e.Sz)(d.Vo,function(a){return a.user})}}},6605:function(a,b,c){"use strict";c.r(b);var d=c(4776),e=c.n(d),f=c(6753),g=c(5632),h=c(8344);c.n(h);var i=c(2139),j=c(678),k=c(2066),l=c(4687);function m(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function n(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){m(f,d,e,g,h,"next",a)}function h(a){m(f,d,e,g,h,"throw",a)}g(void 0)})}}var o,p=function(a){var b=a.scope,c=a.user,d=a.clientId,m=(0,g.useRouter)().push,o=(0,j.a)().user,p=(0,k.useQuery)("get-oauth-app",n(e().mark(function a(){var b;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,l.h.get("/oauth/apps/".concat(d));case 2:return b=a.sent.data,a.abrupt("return",b);case 4:case"end":return a.stop()}},a)}))),q=p.data,r=p.isLoading,s=(0,i.useCallback)(function(){var a=null==o?void 0:o.id;window.location.href="".concat(null==q?void 0:q.callback,"?code=").concat(a,"&source=neo"),(0,h.setCookie)(void 0,"@neo:authorization","true",{maxAge:2592e5})},[null==q?void 0:q.callback,null==o?void 0:o.id]);return((0,i.useEffect)(function(){if(!c){m("/login?return_to=/login/oauth/authorize?scope=".concat(b,"&client_id=").concat(d));return}if("true"===(0,h.parseCookies)()["@neo:authorization"]&&q){var a=c.id;window.location.href="".concat(q.callback,"?code=").concat(a,"&source=neo")}},[q,d,m,b,c]),r)?(0,f.tZ)("div",{children:(0,f.tZ)("p",{children:"is loading..."})}):(0,f.BX)("div",{style:{color:"black"},children:[(0,f.BX)("div",{children:[(0,f.BX)("h3",{children:["authorize with scope: ",(0,f.tZ)("strong",{children:b})]}),(0,f.tZ)("p",{children:null==q?void 0:q.description})]}),(0,f.BX)("div",{children:[(0,f.BX)("button",{onClick:s,children:["Authorize ",null==q?void 0:q.name]}),(0,f.tZ)("br",{}),(0,f.BX)("p",{children:["will redirect to ",(0,f.tZ)("strong",{children:null==q?void 0:q.homepage})]})]})]})};o=n(e().mark(function a(b){var c,d,f,g,i,j,k,m;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(f=!!(d=(c=(0,h.parseCookies)(b))["@neo:access"]),i=(g=b.query).scope,j=g.client_id,f){a.next=5;break}return a.abrupt("return",{scope:i,clientId:j,user:null});case 5:return l.h.defaults.headers.authorization="bearer ".concat(d),a.prev=6,a.next=9,l.h.post("/users/profile");case 9:return m={id:(k=a.sent.data).id},a.abrupt("return",{scope:i,clientId:j,user:m});case 14:return a.prev=14,a.t0=a.catch(6),a.abrupt("return",{scope:i,clientId:j,user:null});case 17:case"end":return a.stop()}},a,null,[[6,14]])})),p.getInitialProps=function(a){return o.apply(this,arguments)},b.default=p}},function(a){a.O(0,[774,888,179],function(){return a(a.s=2326)}),_N_E=a.O()}])